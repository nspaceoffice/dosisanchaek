---
import { urlFor, type Post } from '../lib/sanity';

interface Props {
  post?: Post;
}

const { post } = Astro.props;

const imageUrl = post?.mainImage
  ? urlFor(post.mainImage).width(1920).height(1080).format('webp').url()
  : '/hero-placeholder.jpg';

const formattedDate = post?.publishedAt
  ? new Date(post.publishedAt).toLocaleDateString('ko-KR', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    })
  : '';
---

<section class="relative h-[70vh] min-h-[500px] max-h-[800px] overflow-hidden">
  <!-- Background Image -->
  <div class="absolute inset-0">
    <img
      src={imageUrl}
      alt={post?.title || '도시산책'}
      class="image-cover"
    />
    <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-black/10" />
  </div>

  <!-- Content -->
  <div class="relative h-full flex items-end">
    <div class="container-wide pb-16 md:pb-20">
      {post ? (
        <a href={`/posts/${post.slug.current}`} class="block group">
          {post.category && (
            <span class="inline-block px-4 py-1.5 bg-accent text-white text-sm font-medium rounded-full mb-4">
              {post.category.title}
            </span>
          )}
          <h1 class="text-3xl md:text-5xl lg:text-6xl font-serif font-bold text-white max-w-4xl leading-tight mb-4 text-balance group-hover:text-white/90 transition-colors">
            {post.title}
          </h1>
          {post.excerpt && (
            <p class="text-lg md:text-xl text-white/80 max-w-2xl mb-4 line-clamp-2">
              {post.excerpt}
            </p>
          )}
          <div class="flex items-center gap-4 text-white/60">
            <time>{formattedDate}</time>
            <span class="inline-flex items-center gap-2 text-white group-hover:text-accent transition-colors">
              읽기
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
              </svg>
            </span>
          </div>
        </a>
      ) : (
        <div>
          <h1 class="text-4xl md:text-6xl lg:text-7xl font-serif font-bold text-white max-w-4xl leading-tight mb-4">
            도시산책
          </h1>
          <p class="text-xl md:text-2xl text-white/80 max-w-2xl">
            도시의 풍경과 일상을 담는 미디어 블로그
          </p>
        </div>
      )}
    </div>
  </div>
</section>
