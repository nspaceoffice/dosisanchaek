---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import PostCard from '../components/PostCard.astro';
import { getFeaturedPosts, getAllPosts } from '../lib/sanity';

const featuredPosts = await getFeaturedPosts();
const allPosts = await getAllPosts();

const heroPost = featuredPosts[0];
const gridPosts = allPosts.slice(1, 7);
---

<BaseLayout title="홈">
  <!-- Hero Section -->
  <Hero post={heroPost} />

  <!-- Latest Posts Section -->
  <section class="container-wide py-16 md:py-24">
    <div class="flex items-end justify-between mb-10">
      <div>
        <h2 class="text-3xl md:text-4xl font-serif font-bold text-primary mb-2">
          최신 이야기
        </h2>
        <p class="text-secondary">도시의 풍경과 일상을 담은 이야기들</p>
      </div>
      <a
        href="/posts"
        class="hidden md:inline-flex items-center gap-2 text-accent font-medium hover:underline"
      >
        전체 보기
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>

    <!-- Magazine Grid -->
    <div class="magazine-grid">
      {gridPosts.map((post, index) => (
        <PostCard post={post} featured={index === 0} />
      ))}
    </div>

    <!-- Mobile View All -->
    <div class="mt-10 text-center md:hidden">
      <a
        href="/posts"
        class="inline-flex items-center gap-2 px-6 py-3 bg-primary text-white rounded-full font-medium hover:bg-accent transition-colors"
      >
        전체 글 보기
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </section>

  <!-- Newsletter Section (Optional) -->
  <section class="bg-gray-100 py-16 md:py-24">
    <div class="container-narrow text-center">
      <h2 class="text-2xl md:text-3xl font-serif font-bold text-primary mb-4">
        새로운 이야기를 받아보세요
      </h2>
      <p class="text-secondary mb-8 max-w-lg mx-auto">
        도시산책의 새 글이 발행될 때마다 이메일로 알려드립니다.
      </p>
      <form class="flex flex-col sm:flex-row gap-4 max-w-md mx-auto">
        <input
          type="email"
          placeholder="이메일 주소"
          class="flex-1 px-4 py-3 rounded-full border border-gray-300 focus:border-accent focus:ring-2 focus:ring-accent/20 outline-none"
        />
        <button
          type="submit"
          class="px-8 py-3 bg-primary text-white rounded-full font-medium hover:bg-accent transition-colors"
        >
          구독하기
        </button>
      </form>
    </div>
  </section>
</BaseLayout>
